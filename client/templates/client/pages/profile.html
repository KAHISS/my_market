{% extends "global/pages/index.html" %}

{% block main_content %}
<div class="content-area">
    <div class="content-header">
        <h2><i class="fas fa-user"></i> Perfil de {{ client.user.firstname }} {{ client.user.lastname }}</h2>
    </div>

    <div class="cards">
        <div class="card card-profile">
            {% if client.image %}
                <img src="{{ client.image.url }}" alt="Foto de {{ client.user.username }}">
            {% else %}
                <img src="https://i.pravatar.cc/150?u={{ client.user.email }}" alt="user profile">
            {% endif %}

            <h2>{{ client.name }}</h2>
            <p class="text-secondary">CNPJ: {{ client.cnpj }}</p>

            <hr class="info-divider" style="width: 80%; margin: 20px 0;">

            <div class="profile-kpis">
                <div class="kpi-item">
                    <span class="kpi-value">R$ {{ client.total_spent|floatformat:2 }}</span>
                    <span class="kpi-label">Total Gasto</span>
                </div>
                <div class="kpi-item">
                    <span class="kpi-value">{{ client.total_orders }}</span>
                    <span class="kpi-label">Total de Compras</span>
                </div>
            </div>
        </div>
        
        <div class="card card-infos">
            <h3 class="card-infos-title">Informações do Cliente</h3>

            <ul class="info-list">
                <li>
                    <strong>Email:</strong>
                    <span>{{ client.user.email }}</span>
                </li>
                <li>
                    <strong>Telefone:</strong>
                    <span>{{ client.phone }}</span>
                </li>
                <li>
                    <strong>Endereço:</strong>
                    <span>{{ client.address }}</span>
                </li>
                <li>
                    <strong>Data de Nascimento:</strong>
                    <span>{{ client.date_birth|date:"d/m/Y" }}</span>
                </li>
                <li>
                    <strong>Status:</strong>
                    {% if client.is_active %}
                        <span class="badge badge-green">Ativo</span>
                    {% else %}
                        <span class="badge badge-secondary">Inativo</span>
                    {% endif %}
                </li>
            </ul>

            <hr class="info-divider">

            <h3 class="card-infos-title">Histórico de Compras</h3>
            <ul class="info-list">
                <li>
                    <strong>Cliente Desde:</strong>
                    <span>{{ client.created_at|date:"d/m/Y" }}</span>
                </li>
                <li>
                    <strong>Última Compra:</strong>
                    <span>{{ client.last_purchase_date|date:"d/m/Y" }}</span>
                </li>
            </ul>

            <div class="action-buttons-footer">
                <a href="{% url 'client:edit_client' client.id %}" class="btn btn-edit"><i class="fas fa-edit"></i> Editar</a>
                <a href="{% url 'client:delete_client' client.id %}" class="btn btn-delete"><i class="fas fa-trash"></i> Apagar Cliente</a>
            </div>
        </div>
    </div>
</div>
{% endblock main_content %}

<! Sidebar Links>
{% block sidebar_links %}
{% include 'client/partials/sidebarLinks.html' %}
{% endblock sidebar_links %}
